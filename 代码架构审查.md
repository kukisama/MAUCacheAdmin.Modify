# MAUCacheAdmin.Modify ä»£ç æ¶æ„å®¡æŸ¥æŠ¥å‘Š

> å®¡æŸ¥æ—¥æœŸï¼š2026-02-16  
> é¡¹ç›®æ¥æºï¼šåŸºäº [pbowden-msft/MAUCacheAdmin](https://github.com/pbowden-msft/MAUCacheAdmin) çš„ä¿®æ”¹ç‰ˆæœ¬  
> è¯­è¨€/æ¡†æ¶ï¼šPowerShell 5.1+ / PowerShell Core å…¼å®¹

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [ç›®å½•ç»“æ„](#2-ç›®å½•ç»“æ„)
3. [æ¶æ„è®¾è®¡](#3-æ¶æ„è®¾è®¡)
4. [æ—¶åºå›¾](#4-æ—¶åºå›¾)
5. [æ¨¡å—è¯¦ç»†è¯´æ˜](#5-æ¨¡å—è¯¦ç»†è¯´æ˜)
6. [åŠŸèƒ½æ­£å¸¸æ€§è¯„ä¼°](#6-åŠŸèƒ½æ­£å¸¸æ€§è¯„ä¼°)
7. [å·²å‘ç°é—®é¢˜ä¸é£é™©](#7-å·²å‘ç°é—®é¢˜ä¸é£é™©)
8. [æ”¹è¿›æ„è§](#8-æ”¹è¿›æ„è§)
9. [åŠŸèƒ½æ–°å¢å»ºè®®](#9-åŠŸèƒ½æ–°å¢å»ºè®®)
10. [æ€»ç»“](#10-æ€»ç»“)

---

## 1. é¡¹ç›®æ¦‚è¿°

MAUCacheAdmin.Modify æ˜¯ä¸€ä¸ª PowerShell å·¥å…·é›†ï¼Œç”¨äºç®¡ç† **Microsoft AutoUpdate (MAU)** çš„æœ¬åœ°ç¼“å­˜æœåŠ¡å™¨ã€‚å®ƒä» Microsoft Office CDN ä¸‹è½½ macOS ç‰ˆ Office åº”ç”¨ç¨‹åºçš„æ›´æ–°åŒ…ï¼ˆ.pkgï¼‰ï¼Œå¹¶å°†å…¶ç¼“å­˜åˆ°æœ¬åœ° IIS æˆ–å…¶ä»– Web æœåŠ¡å™¨ä¸Šï¼Œä½¿å†…ç½‘ Mac å®¢æˆ·ç«¯å¯ä»¥ä»æœ¬åœ°æœåŠ¡å™¨è·å–æ›´æ–°ï¼Œè€Œæ— éœ€æ¯å°è®¾å¤‡éƒ½ç›´æ¥ä»äº’è”ç½‘ä¸‹è½½ã€‚

### ä¸»è¦åŠŸèƒ½

- ä» Microsoft CDN è·å– macOS Office ç”Ÿäº§ç‰ˆæœ¬ï¼ˆProductionï¼‰æ„å»ºä¿¡æ¯
- è§£æ Plist XML æ ¼å¼çš„åº”ç”¨æ¸…å•æ–‡ä»¶
- ä¸‹è½½å…¨é‡åŒ…å’Œå¢é‡æ›´æ–°åŒ…ï¼ˆDeltaï¼‰
- ä¿å­˜ç¼–å½•æ–‡ä»¶ï¼ˆCollateralsï¼šXMLã€CATã€CHK æ–‡ä»¶ï¼‰
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ–‡ä»¶
- æ”¯æŒ IIS æœåŠ¡å™¨çš„è‡ªåŠ¨é…ç½®
- æ”¯æŒ Windows è®¡åˆ’ä»»åŠ¡å’Œ Linux systemd æœåŠ¡çš„è‡ªåŠ¨éƒ¨ç½²

---

## 2. ç›®å½•ç»“æ„

```
MAUCacheAdmin.Modify/
â”œâ”€â”€ MacUpdatesOffice.Modify.ps1          # ä¸»å…¥å£è„šæœ¬
â”œâ”€â”€ CreateScheduledTask.ps1               # Windows è®¡åˆ’ä»»åŠ¡åˆ›å»ºè„šæœ¬
â”œâ”€â”€ PrepIISServer.ps1                     # IIS æœåŠ¡å™¨é…ç½®è„šæœ¬
â”œâ”€â”€ maucache.service                      # Linux systemd æœåŠ¡é…ç½®
â”œâ”€â”€ README.md                             # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ config_profile_examples/              # Mac å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ com.microsoft.autoupdate2-prod.plist   # ç”Ÿäº§ç¯å¢ƒå®¢æˆ·ç«¯é…ç½®
â”‚   â””â”€â”€ com.microsoft.autoupdate2-test.plist   # æµ‹è¯•ç¯å¢ƒå®¢æˆ·ç«¯é…ç½®
â””â”€â”€ PSModule/                             # PowerShell æ¨¡å—ç›®å½•
    â”œâ”€â”€ MAUCacheAdmin.Tests.ps1           # Pester å•å…ƒæµ‹è¯•
    â””â”€â”€ MAUCacheAdmin/                    # æ ¸å¿ƒæ¨¡å—
        â”œâ”€â”€ MAUCacheAdmin.psd1            # æ¨¡å—æ¸…å•
        â”œâ”€â”€ MAUCacheAdmin.psm1            # æ¨¡å—åŠ è½½å™¨
        â”œâ”€â”€ README.md                     # æ¨¡å—è¯´æ˜æ–‡æ¡£
        â”œâ”€â”€ Public/                       # å…¬å¼€å‡½æ•°ï¼ˆå¯¹å¤–æš´éœ²çš„ APIï¼‰
        â”‚   â”œâ”€â”€ Get-MAUApps.ps1
        â”‚   â”œâ”€â”€ Get-MAUCacheDownloadJobs.ps1
        â”‚   â”œâ”€â”€ Get-MAUProductionBuilds.ps1
        â”‚   â”œâ”€â”€ Invoke-MAUCacheDownload.ps1
        â”‚   â”œâ”€â”€ Save-MAUCollaterals.ps1
        â”‚   â”œâ”€â”€ Save-oldMAUCollaterals.ps1
        â”‚   â””â”€â”€ Set-MAUCacheAdminHttpClientHandler.ps1
        â””â”€â”€ Private/                      # ç§æœ‰å‡½æ•°ï¼ˆæ¨¡å—å†…éƒ¨ä½¿ç”¨ï¼‰
            â”œâ”€â”€ ConvertFrom-AppPackageDictionary.ps1
            â”œâ”€â”€ ConvertFrom-BytesToString.ps1
            â”œâ”€â”€ ConvertFrom-Plist.ps1
            â”œâ”€â”€ Get-HttpClientHandler.ps1
            â”œâ”€â”€ Get-MAUApp.ps1
            â”œâ”€â”€ Get-PlistFromURI.ps1
            â”œâ”€â”€ Invoke-HttpClientDownload.ps1
            â””â”€â”€ Utilities.ps1
```

---

## 3. æ¶æ„è®¾è®¡

### 3.1 æ•´ä½“æ¶æ„å›¾

```mermaid
graph TB
    subgraph "å¤–éƒ¨ç³»ç»Ÿ"
        CDN["Microsoft Office CDN<br/>(officecdnmac.microsoft.com)"]
        MAC["Mac å®¢æˆ·ç«¯<br/>(Microsoft AutoUpdate)"]
    end

    subgraph "MAUCacheAdmin.Modify ç³»ç»Ÿ"
        subgraph "å…¥å£å±‚"
            MAIN["MacUpdatesOffice.Modify.ps1<br/>ä¸»å…¥å£è„šæœ¬"]
            TASK["CreateScheduledTask.ps1<br/>è®¡åˆ’ä»»åŠ¡"]
            IIS["PrepIISServer.ps1<br/>IIS é…ç½®"]
            SVC["maucache.service<br/>systemd æœåŠ¡"]
        end

        subgraph "å…¬å¼€ API å±‚ (Public)"
            GAP["Get-MAUApps<br/>è·å–åº”ç”¨åˆ—è¡¨"]
            GPB["Get-MAUProductionBuilds<br/>è·å–æ„å»ºç‰ˆæœ¬"]
            GDJ["Get-MAUCacheDownloadJobs<br/>ç”Ÿæˆä¸‹è½½ä»»åŠ¡"]
            ICD["Invoke-MAUCacheDownload<br/>æ‰§è¡Œä¸‹è½½"]
            SMC["Save-MAUCollaterals<br/>ä¿å­˜ç¼–å½•æ–‡ä»¶"]
            SOC["Save-oldMAUCollaterals<br/>ä¿å­˜æ—§ç¼–å½•æ–‡ä»¶"]
            SHC["Set-MAUCacheAdminHttpClientHandler<br/>é…ç½®HTTPå®¢æˆ·ç«¯"]
        end

        subgraph "ç§æœ‰å·¥å…·å±‚ (Private)"
            GMA["Get-MAUApp<br/>è·å–å•ä¸ªåº”ç”¨ä¿¡æ¯"]
            GPL["Get-PlistFromURI<br/>ä»URIè·å–Plist"]
            CFP["ConvertFrom-Plist<br/>Plist XMLè§£æ"]
            CAP["ConvertFrom-AppPackageDictionary<br/>åŒ…å­—å…¸è½¬æ¢"]
            IHD["Invoke-HttpClientDownload<br/>HTTPæ–‡ä»¶ä¸‹è½½"]
            GHC["Get-HttpClientHandler<br/>è·å–HTTPå¤„ç†å™¨"]
            CBS["ConvertFrom-BytesToString<br/>å­—èŠ‚æ ¼å¼åŒ–"]
            UTL["Utilities.ps1<br/>FixLineBreaks"]
        end

        subgraph "æ•°æ®å­˜å‚¨å±‚"
            CACHE["ç¼“å­˜ç›®å½•<br/>(CachePath)"]
            SCRATCH["ä¸´æ—¶ç›®å½•<br/>(ScratchPath)"]
            COLLATERAL["ç¼–å½•ç›®å½•<br/>(collateral/)"]
        end

        subgraph "Web æœåŠ¡å™¨"
            WEBSRV["IIS / Nginx / Apache<br/>æ–‡ä»¶æœåŠ¡å™¨"]
        end
    end

    CDN -->|"HTTPS è¯·æ±‚"| GPB
    CDN -->|"HTTPS è¯·æ±‚"| GAP
    CDN -->|"HTTPS è¯·æ±‚"| ICD
    CDN -->|"HTTPS è¯·æ±‚"| SMC

    MAIN --> GAP
    MAIN --> GPB
    MAIN --> GDJ
    MAIN --> ICD
    MAIN --> SMC
    MAIN --> SOC

    TASK -->|"å®šæ—¶è§¦å‘"| MAIN
    SVC -->|"å®šæ—¶è§¦å‘"| MAIN

    GAP --> GMA
    GMA --> GPL
    GPL --> CFP
    GMA --> CAP
    GPB --> GHC
    GPB --> UTL
    GDJ --> GHC
    ICD --> IHD
    ICD --> CBS
    SMC --> IHD
    SOC --> IHD
    IHD --> GHC
    SHC --> GHC

    ICD --> SCRATCH
    ICD --> CACHE
    SMC --> CACHE
    SMC --> COLLATERAL
    SOC --> COLLATERAL

    WEBSRV --> CACHE
    WEBSRV --> COLLATERAL
    MAC -->|"HTTP è¯·æ±‚"| WEBSRV

    IIS -->|"é…ç½®"| WEBSRV
```

### 3.2 æ¨¡å—å±‚æ¬¡æ¶æ„å›¾

```mermaid
graph LR
    subgraph "æ¨¡å—åŠ è½½ (MAUCacheAdmin.psm1)"
        LOADER["æ¨¡å—åŠ è½½å™¨<br/>Â· æ‰«æ Public/*.ps1<br/>Â· æ‰«æ Private/*.ps1<br/>Â· Dot-source æ‰€æœ‰æ–‡ä»¶<br/>Â· Export Public å‡½æ•°"]
    end

    subgraph "Public å‡½æ•° (7ä¸ª)"
        P1["Get-MAUProductionBuilds"]
        P2["Get-MAUApps"]
        P3["Get-MAUCacheDownloadJobs"]
        P4["Invoke-MAUCacheDownload"]
        P5["Save-MAUCollaterals"]
        P6["Save-oldMAUCollaterals"]
        P7["Set-MAUCacheAdminHttpClientHandler"]
    end

    subgraph "Private å‡½æ•° (8ä¸ª)"
        R1["Get-MAUApp"]
        R2["Get-PlistFromURI"]
        R3["ConvertFrom-Plist"]
        R4["ConvertFrom-AppPackageDictionary"]
        R5["Invoke-HttpClientDownload"]
        R6["Get-HttpClientHandler"]
        R7["ConvertFrom-BytesToString"]
        R8["Utilities (FixLineBreaks)"]
    end

    LOADER --> P1 & P2 & P3 & P4 & P5 & P6 & P7
    LOADER --> R1 & R2 & R3 & R4 & R5 & R6 & R7 & R8
```

### 3.3 å‡½æ•°è°ƒç”¨å…³ç³»å›¾

```mermaid
graph TD
    MAIN["MacUpdatesOffice.Modify.ps1"]

    MAIN -->|"1"| GPB["Get-MAUProductionBuilds"]
    MAIN -->|"2"| GAP["Get-MAUApps"]
    MAIN -->|"3"| SMC["Save-MAUCollaterals"]
    MAIN -->|"4"| SOC["Save-oldMAUCollaterals"]
    MAIN -->|"5"| GDJ["Get-MAUCacheDownloadJobs"]
    MAIN -->|"6"| ICD["Invoke-MAUCacheDownload"]

    GPB --> GHC["Get-HttpClientHandler"]
    GPB --> UTL["FixLineBreaks"]

    GAP --> GMA["Get-MAUApp"]
    GMA --> GPL["Get-PlistFromURI"]
    GMA --> CAP["ConvertFrom-AppPackageDictionary"]
    GPL --> CFP["ConvertFrom-Plist"]

    GDJ --> GHC

    ICD --> IHD["Invoke-HttpClientDownload"]
    ICD --> CBS["ConvertFrom-BytesToString"]
    IHD --> GHC

    SMC --> IHD
    SOC --> IHD
```

### 3.4 æ•°æ®æµæ¶æ„å›¾

```mermaid
graph LR
    subgraph "Microsoft CDN"
        BT["builds.txt<br/>ç‰ˆæœ¬åˆ—è¡¨"]
        AX["AppID.xml<br/>åº”ç”¨åŒ…æ¸…å•"]
        CK["AppID-chk.xml<br/>ç‰ˆæœ¬æ£€æŸ¥"]
        HX["AppID-history.xml<br/>å†å²ç‰ˆæœ¬"]
        CT["AppID.cat<br/>ç¼–å½•æ–‡ä»¶"]
        PK[".pkg æ–‡ä»¶<br/>æ›´æ–°åŒ…"]
    end

    subgraph "æ•°æ®æ¨¡å‹"
        BUILDS["string[]<br/>æ„å»ºç‰ˆæœ¬æ•°ç»„"]
        APPS["MAUApp[]<br/>åº”ç”¨å¯¹è±¡æ•°ç»„"]
        JOBS["DownloadJob[]<br/>ä¸‹è½½ä»»åŠ¡æ•°ç»„"]
    end

    subgraph "æœ¬åœ°ç¼“å­˜"
        LP[".pkg æ–‡ä»¶"]
        LC["collateral/<br/>ç¼–å½•æ–‡ä»¶"]
        LR["æ ¹ç›®å½•<br/>xml/catæ–‡ä»¶"]
    end

    BT -->|"Get-MAUProductionBuilds"| BUILDS
    AX -->|"Get-MAUApps"| APPS
    CK -->|"Get-MAUApps"| APPS
    HX -->|"Get-MAUApps"| APPS

    APPS -->|"Get-MAUCacheDownloadJobs"| JOBS
    BUILDS -->|"è¿‡æ»¤ Delta"| JOBS

    PK -->|"Invoke-MAUCacheDownload"| LP
    AX -->|"Save-MAUCollaterals"| LR
    CT -->|"Save-MAUCollaterals"| LR
    AX -->|"Save-oldMAUCollaterals"| LC
    CT -->|"Save-oldMAUCollaterals"| LC
    CK -->|"Save-MAUCollaterals"| LR
```

---

## 4. æ—¶åºå›¾

### 4.1 ä¸»æµç¨‹æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·/è®¡åˆ’ä»»åŠ¡
    participant Main as MacUpdatesOffice.Modify.ps1
    participant Module as MAUCacheAdmin Module
    participant CDN as Microsoft CDN
    participant Disk as æœ¬åœ°ç£ç›˜

    User->>Main: æ‰§è¡Œè„šæœ¬(workPath, maupath, mautemppath)
    
    Note over Main: é˜¶æ®µ0: æ¸…ç†æ—§æ–‡ä»¶
    Main->>Disk: åˆ é™¤è¿‡æœŸæ–‡ä»¶<br/>(Lync Installer.pkg, MicrosoftTeams.pkg,<br/>Teams_osx.pkg, wdav-upgrade.pkg,<br/>*.xml, builds.txt, *.cat)
    
    Note over Main: é˜¶æ®µ1: åŠ è½½æ¨¡å—
    Main->>Module: Import-Module MAUCacheAdmin.psm1
    Main->>Main: Add-Type System.Net.Http

    Note over Main: é˜¶æ®µ2: è·å–æ„å»ºç‰ˆæœ¬
    Main->>Module: Get-MAUProductionBuilds
    Module->>CDN: GET builds.txt
    CDN-->>Module: ç‰ˆæœ¬åˆ—è¡¨æ–‡æœ¬
    Module-->>Main: string[] $builds

    Note over Main: é˜¶æ®µ3: è·å–åº”ç”¨ä¿¡æ¯
    Main->>Module: Get-MAUApps -Channel Production
    
    loop æ¯ä¸ªåº”ç”¨ (20ä¸ª)
        Module->>CDN: GET {AppID}.xml
        CDN-->>Module: Plist XML (åŒ…åˆ—è¡¨)
        Module->>CDN: GET {AppID}-chk.xml
        CDN-->>Module: Plist XML (ç‰ˆæœ¬ä¿¡æ¯)
        Module->>CDN: GET {AppID}-history.xml (å¯é€‰)
        CDN-->>Module: Plist XML (å†å²ç‰ˆæœ¬) æˆ– 404
    end
    
    Module-->>Main: MAUApp[] $apps

    Note over Main: é˜¶æ®µ4: ä¿å­˜ç¼–å½•æ–‡ä»¶
    Main->>Module: Save-MAUCollaterals($apps, $maupath, isProd=true)
    
    loop æ¯ä¸ªåº”ç”¨
        Module->>CDN: GET {AppID}_{version}.xml
        Module->>CDN: GET {AppID}_{version}.cat
        Module->>CDN: GET {AppID}.xml
        Module->>CDN: GET {AppID}.cat
        Module->>CDN: GET {AppID}-chk.xml
        Module->>Disk: ä¿å­˜åˆ° $maupath/
    end

    Main->>Module: Save-oldMAUCollaterals($apps, $maupath)
    
    loop æ¯ä¸ªåº”ç”¨
        Module->>CDN: GET {AppID}.xml
        Module->>CDN: GET {AppID}.cat
        Module->>CDN: GET {AppID}-chk.xml
        Module->>Disk: ä¿å­˜åˆ° $maupath/collateral/{version}/
    end

    Note over Main: é˜¶æ®µ5: ä¸‹è½½æ›´æ–°åŒ…
    loop æ¯ä¸ªåº”ç”¨
        Main->>Module: Get-MAUCacheDownloadJobs($app, $builds)
        
        loop æ¯ä¸ªåŒ… URI
            Module->>CDN: HEAD {package_url}
            CDN-->>Module: Content-Length, Last-Modified
        end
        
        Module-->>Main: DownloadJob[] $dlJobs

        Main->>Module: Invoke-MAUCacheDownload($dlJobs, $maupath, $mautemppath)
        
        loop æ¯ä¸ªä¸‹è½½ä»»åŠ¡
            alt ç¼“å­˜æœ‰æ•ˆ
                Module->>Module: è·³è¿‡ä¸‹è½½
            else ç¼“å­˜æ— æ•ˆæˆ–ä¸å­˜åœ¨
                Module->>CDN: GET {package_url}
                CDN-->>Module: .pkg æ–‡ä»¶æµ
                Module->>Disk: å†™å…¥ ScratchPath
                Module->>Disk: ç§»åŠ¨åˆ° CachePath
            end
        end
    end

    Main-->>User: å®Œæˆ
```

### 4.2 HTTP ä¸‹è½½æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant Caller as è°ƒç”¨æ–¹
    participant IHD as Invoke-HttpClientDownload
    participant GHC as Get-HttpClientHandler
    participant HC as HttpClient
    participant CDN as Microsoft CDN
    participant FS as FileSystem

    Caller->>IHD: è°ƒç”¨(Uri, OutFile/Path, Force)
    IHD->>GHC: è·å– HttpClientHandler
    GHC-->>IHD: HttpClientHandler (å•ä¾‹)
    IHD->>HC: åˆ›å»º HttpClient(handler, false)
    
    IHD->>HC: GetAsync(Uri, ResponseHeadersRead)
    HC->>CDN: HTTP GET è¯·æ±‚
    CDN-->>HC: HTTP å“åº” (headers)
    HC-->>IHD: HttpResponseMessage
    
    alt çŠ¶æ€ç ä¸æˆåŠŸ
        IHD->>IHD: Throw å¼‚å¸¸
    end

    IHD->>IHD: ç¡®å®šç›®æ ‡æ–‡ä»¶è·¯å¾„
    IHD->>HC: ReadAsStreamAsync()
    
    IHD->>FS: File.Create(targetPath)
    
    loop è¯»å–æ•°æ®å— (256KB)
        HC-->>IHD: æ•°æ®å—
        IHD->>FS: Write(buffer)
        IHD->>IHD: Write-Progress è¿›åº¦æ›´æ–°
    end
    
    IHD->>FS: å…³é—­æ–‡ä»¶æµ
    
    alt UseRemoteLastModified
        IHD->>FS: è®¾ç½® LastWriteTimeUtc
    end

    IHD-->>Caller: å®Œæˆ

    Note over IHD: finally å—
    IHD->>HC: Dispose()
    IHD->>FS: Dispose()
```

### 4.3 Plist è§£ææ—¶åºå›¾

```mermaid
sequenceDiagram
    participant GMA as Get-MAUApp
    participant GPL as Get-PlistFromURI
    participant HC as HttpClient
    participant CDN as Microsoft CDN
    participant CFP as ConvertFrom-Plist
    participant CAP as ConvertFrom-AppPackageDictionary

    GMA->>GPL: Get-PlistObjectFromURI(AppXML URI)
    GPL->>HC: GetStringAsync(URI)
    HC->>CDN: GET AppID.xml
    CDN-->>HC: XML å­—ç¬¦ä¸²
    HC-->>GPL: XML å­—ç¬¦ä¸²
    GPL->>GPL: è½¬æ¢ä¸º [xml] å¯¹è±¡
    GPL->>CFP: ConvertFrom-Plist(xml)
    
    Note over CFP: é€’å½’è§£æ Plist ç»“æ„
    CFP->>CFP: processTree(plist.FirstChild)
    
    loop è§£ææ¯ä¸ªèŠ‚ç‚¹
        alt dict èŠ‚ç‚¹
            CFP->>CFP: åˆ›å»º OrderedDictionary
        else array èŠ‚ç‚¹
            CFP->>CFP: é€’å½’åˆ›å»ºæ•°ç»„
        else string/integer/real/date èŠ‚ç‚¹
            CFP->>CFP: è§£æä¸ºå¯¹åº”ç±»å‹
        else data èŠ‚ç‚¹
            CFP->>CFP: Base64 è§£ç ä¸º byte[]
        end
    end
    
    CFP-->>GPL: OrderedDictionary[]
    GPL-->>GMA: OrderedDictionary[]
    
    GMA->>CAP: ConvertFrom-AppPackageDictionary(dicts)
    CAP->>CAP: è½¬æ¢ä¸º PSCustomObject[]
    CAP-->>GMA: PSCustomObject[] (åŒ…ä¿¡æ¯)
```

### 4.4 IIS æœåŠ¡å™¨é…ç½®æ—¶åºå›¾

```mermaid
sequenceDiagram
    participant Admin as ç®¡ç†å‘˜
    participant PS as PrepIISServer.ps1
    participant IIS as IIS æœåŠ¡
    participant REG as Windows æ³¨å†Œè¡¨

    Admin->>PS: æ‰§è¡Œè„šæœ¬
    
    PS->>IIS: Install-WindowsFeature Web-Server
    IIS-->>PS: å®‰è£…å®Œæˆ
    
    PS->>PS: åˆ›å»ºç›®å½• C:\MAUupdate
    
    PS->>IIS: Import-Module WebAdministration
    PS->>IIS: è®¾ç½® Default Web Site ç‰©ç†è·¯å¾„
    PS->>IIS: å¯ç”¨ç›®å½•æµè§ˆ
    
    loop æ·»åŠ  MIME ç±»å‹
        PS->>IIS: æ£€æŸ¥ .pkg MIME ç±»å‹
        alt ä¸å­˜åœ¨
            PS->>IIS: æ·»åŠ  .pkg -> application/octet-stream
        end
        PS->>IIS: æ£€æŸ¥ .cat MIME ç±»å‹
        PS->>IIS: æ£€æŸ¥ .xml MIME ç±»å‹
        PS->>IIS: æ£€æŸ¥ .mpkg MIME ç±»å‹
    end
    
    PS->>REG: ç¦ç”¨ IE ESC (ç®¡ç†å‘˜)
    PS->>REG: ç¦ç”¨ IE ESC (ç”¨æˆ·)
    PS->>PS: é‡å¯ Explorer
    
    PS-->>Admin: é…ç½®å®Œæˆ
```

---

## 5. æ¨¡å—è¯¦ç»†è¯´æ˜

### 5.1 å…¥å£è„šæœ¬

#### MacUpdatesOffice.Modify.ps1

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | ä¸»å…¥å£è„šæœ¬ï¼Œç¼–æ’æ•´ä¸ªç¼“å­˜æ›´æ–°æµç¨‹ |
| å‚æ•° | `$workPath`ï¼ˆå·¥ä½œè·¯å¾„ï¼‰ã€`$maupath`ï¼ˆç¼“å­˜è·¯å¾„ï¼‰ã€`$mautemppath`ï¼ˆä¸´æ—¶è·¯å¾„ï¼‰ |
| æµç¨‹ | æ¸…ç†æ—§æ–‡ä»¶ â†’ åŠ è½½æ¨¡å— â†’ è·å–æ„å»ºç‰ˆæœ¬ â†’ è·å–åº”ç”¨ä¿¡æ¯ â†’ ä¿å­˜ç¼–å½• â†’ ä¸‹è½½æ›´æ–°åŒ… |

### 5.2 Public å‡½æ•°è¯¦ç»†è¯´æ˜

#### Get-MAUProductionBuilds

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | ä» CDN è·å–å½“å‰ç”Ÿäº§ç¯å¢ƒçš„æ„å»ºç‰ˆæœ¬åˆ—è¡¨ |
| è¾“å…¥ | æ— å‚æ•° |
| è¾“å‡º | `string[]` ç‰ˆæœ¬å·æ•°ç»„ |
| CDN ç«¯ç‚¹ | `https://officecdnmac.microsoft.com/.../builds.txt` |
| ä¾èµ– | `Get-HttpClientHandler`ã€`FixLineBreaks` |

#### Get-MAUApps

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | è·å–æŒ‡å®šé€šé“ï¼ˆProduction/Preview/Betaï¼‰çš„æ‰€æœ‰åº”ç”¨ä¿¡æ¯ |
| è¾“å…¥ | `$Channel` - æ¸ é“åç§°ï¼ˆProduction/Preview/Betaï¼‰ |
| è¾“å‡º | `PSCustomObject[]` åº”ç”¨å¯¹è±¡æ•°ç»„ |
| æ”¯æŒçš„åº”ç”¨ | MAU 4.x, Word, Excel, PowerPoint, Outlook, OneNote (365/2021/2019 & 2016), Skype for Business, Intune Company Portal, Remote Desktop v10, OneDrive, Defender ATP, Edge, Teams 1.0 classic, Teams 2.1, Office Licensing Helperï¼ˆå…±20ä¸ªï¼‰ |
| ä¾èµ– | `Get-MAUApp` â†’ `Get-PlistFromURI` â†’ `ConvertFrom-Plist` |

#### Get-MAUCacheDownloadJobs

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | æ ¹æ®åº”ç”¨ä¿¡æ¯å’Œæ„å»ºç‰ˆæœ¬ï¼Œç”Ÿæˆä¸‹è½½ä»»åŠ¡åˆ—è¡¨ |
| è¾“å…¥ | `$MAUApps`ï¼ˆåº”ç”¨åˆ—è¡¨ï¼‰ã€`$DeltaFromBuildLimiter`/`$DeltaToBuildLimiter`ï¼ˆç‰ˆæœ¬è¿‡æ»¤å™¨ï¼‰ã€`$IncludeHistoricDeltas`/`$IncludeHistoricVersions`ï¼ˆå¼€å…³ï¼‰ |
| è¾“å‡º | `PSCustomObject[]` - åŒ…å« AppName, LocationUri, Payload, SizeBytes, LastModified |
| é€»è¾‘ | æ”¶é›†æ‰€æœ‰åŒ… URI â†’ åº”ç”¨è¿‡æ»¤è§„åˆ™ â†’ å¯¹æ¯ä¸ª URI å‘é€ HEAD è¯·æ±‚è·å–å…ƒä¿¡æ¯ |

#### Invoke-MAUCacheDownload

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | æ‰§è¡Œå®é™…çš„æ–‡ä»¶ä¸‹è½½æ“ä½œ |
| è¾“å…¥ | `$MAUCacheDownloadJobs`ã€`$CachePath`ã€`$ScratchPath`ã€`$Force`ã€`$Mirror`ã€`$CompareLastModified` |
| é€»è¾‘ | éªŒè¯ç¼“å­˜æœ‰æ•ˆæ€§ï¼ˆæ–‡ä»¶å­˜åœ¨ + å¤§å°åŒ¹é… + å¯é€‰çš„ä¿®æ”¹æ—¶é—´åŒ¹é…ï¼‰ â†’ æ— æ•ˆåˆ™ä¸‹è½½åˆ° ScratchPath â†’ ç§»åŠ¨åˆ° CachePath |
| é‡è¯• | å¯¹ "The response ended prematurely" é”™è¯¯æœ€å¤šé‡è¯• 2 æ¬¡ |
| Mirror æ¨¡å¼ | åˆ é™¤ CachePath ä¸­ä¸åœ¨ä¸‹è½½ä»»åŠ¡åˆ—è¡¨ä¸­çš„å¤šä½™æ–‡ä»¶ |

#### Save-MAUCollaterals

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | ä¿å­˜ç¼–å½•æ–‡ä»¶ï¼ˆXMLã€CAT ç­‰ï¼‰ |
| è¾“å…¥ | `$MAUApps`ã€`$CachePath`ã€`$isProd` |
| é€»è¾‘ | `isProd=true` æ—¶ä¿å­˜åˆ°æ ¹ç›®å½•ï¼›`isProd=false` æ—¶ä¿å­˜åˆ° `collateral/{version}/` å­ç›®å½• |
| ç‰¹æ®Šå¤„ç† | ç”Ÿæˆå¸¦ç‰ˆæœ¬å·çš„ CAT å’Œ XML æ–‡ä»¶ URIï¼ˆå¦‚ `AppID_version.cat`ï¼‰ |

#### Save-oldMAUCollaterals

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | ä¿å­˜æ—§ç‰ˆç¼–å½•æ–‡ä»¶åˆ° `collateral/{version}/` å­ç›®å½• |
| è¾“å…¥ | `$MAUApps`ã€`$CachePath` |
| é€»è¾‘ | æ€»æ˜¯ä¿å­˜åˆ° `collateral/{version}/` ç›®å½•ä¸‹ |

#### Set-MAUCacheAdminHttpClientHandler

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | å…è®¸æ³¨å…¥è‡ªå®šä¹‰çš„ HttpClientHandlerï¼ˆä¾‹å¦‚é…ç½®ä»£ç†ï¼‰ |
| è¾“å…¥ | `$Handler` - System.Net.Http.HttpClientHandler å¯¹è±¡ |
| ä½œç”¨åŸŸ | è®¾ç½®åˆ° `$Script:HttpClientHandler`ï¼Œå½±å“æ¨¡å—å†…æ‰€æœ‰åç»­ HTTP è¯·æ±‚ |

### 5.3 Private å‡½æ•°è¯¦ç»†è¯´æ˜

| å‡½æ•°å | åŠŸèƒ½ | å…³é”®ç»†èŠ‚ |
|--------|------|----------|
| `Get-MAUApp` | è·å–å•ä¸ªåº”ç”¨çš„å®Œæ•´ä¿¡æ¯ | å¤„ç† AppXMLã€ChkXmlã€HistoryXMLï¼Œä¿®å¤ version=99999 çš„æƒ…å†µ |
| `Get-PlistFromURI` | ä» URI è·å–å¹¶è§£æ Plist | æ”¯æŒ `$Optional` å‚æ•°å¤„ç†å¯é€‰èµ„æºçš„ 404 æƒ…å†µ |
| `ConvertFrom-Plist` | XML Plist è½¬ PowerShell å¯¹è±¡ | é€’å½’è§£æ dict/array/string/integer/real/date/data ç±»å‹ |
| `ConvertFrom-AppPackageDictionary` | OrderedDictionary è½¬ PSCustomObject | ç®€å•çš„ç±»å‹è½¬æ¢ |
| `Invoke-HttpClientDownload` | HTTP æ–‡ä»¶ä¸‹è½½ | ä½¿ç”¨æµå¼ä¸‹è½½ï¼ˆ256KB ç¼“å†²åŒºï¼‰ï¼Œæ”¯æŒè¿›åº¦æ¡æ˜¾ç¤º |
| `Get-HttpClientHandler` | è·å–/åˆ›å»º HttpClientHandler å•ä¾‹ | å»¶è¿Ÿåˆå§‹åŒ–æ¨¡å¼ |
| `ConvertFrom-BytesToString` | å­—èŠ‚æ•°æ ¼å¼åŒ– | æ”¯æŒ KB/MB/GB/TB/PB å•ä½ |
| `FixLineBreaks` | ä¿®å¤æ¢è¡Œç¬¦ | åŒºåˆ† PS 5.x å’Œ PS 6.0+ çš„æ­£åˆ™å¤„ç†å·®å¼‚ |

### 5.4 è¾…åŠ©è„šæœ¬

| è„šæœ¬ | åŠŸèƒ½ | å…³é”®ç»†èŠ‚ |
|------|------|----------|
| `PrepIISServer.ps1` | é…ç½® Windows IIS ä½œä¸ºç¼“å­˜æœåŠ¡å™¨ | å®‰è£… IISã€é…ç½®ç«™ç‚¹è·¯å¾„ã€å¯ç”¨ç›®å½•æµè§ˆã€æ·»åŠ  MIME ç±»å‹ã€ç¦ç”¨ IE ESC |
| `CreateScheduledTask.ps1` | åˆ›å»º Windows è®¡åˆ’ä»»åŠ¡ | æä¾›ä¸€æ¬¡æ€§å’Œæ¯å‘¨æ‰§è¡Œä¸¤ç§æ¨¡å¼ |
| `maucache.service` | Linux systemd æœåŠ¡é…ç½® | æœåŠ¡å´©æºƒå 5 åˆ†é’Ÿè‡ªåŠ¨é‡å¯ï¼Œå¹¶å‘é€é‚®ä»¶é€šçŸ¥ |

---

## 6. åŠŸèƒ½æ­£å¸¸æ€§è¯„ä¼°

### 6.1 æ ¸å¿ƒåŠŸèƒ½è¯„ä¼°

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ¨¡å—åŠ è½½ | âœ… æ­£å¸¸ | PSM1 åŠ è½½å™¨ä½¿ç”¨æ ‡å‡†çš„ Public/Private æ¨¡å¼ |
| CDN é€šä¿¡ | âœ… æ­£å¸¸ | ä½¿ç”¨ HttpClientï¼Œå…¼å®¹ PS 5.1+ |
| Plist è§£æ | âœ… æ­£å¸¸ | å®Œæ•´æ”¯æŒ Plist XML æ‰€æœ‰æ•°æ®ç±»å‹ |
| ç‰ˆæœ¬è·å– | âœ… æ­£å¸¸ | ä» builds.txt æ­£ç¡®è§£æç‰ˆæœ¬åˆ—è¡¨ |
| åº”ç”¨æšä¸¾ | âœ… æ­£å¸¸ | è¦†ç›– 20 ä¸ª Office åº”ç”¨ |
| æ–‡ä»¶ä¸‹è½½ | âš ï¸ éƒ¨åˆ†æ­£å¸¸ | æµå¼ä¸‹è½½æ­£å¸¸ï¼Œä½†é”™è¯¯å¤„ç†æœ‰æ”¹è¿›ç©ºé—´ |
| ç¼–å½•ä¿å­˜ | âœ… æ­£å¸¸ | æ”¯æŒæ ¹ç›®å½•å’Œ collateral å­ç›®å½•ä¸¤ç§æ¨¡å¼ |
| ç¼“å­˜éªŒè¯ | âœ… æ­£å¸¸ | åŸºäºæ–‡ä»¶å¤§å°éªŒè¯ï¼Œå¯é€‰ä¿®æ”¹æ—¶é—´éªŒè¯ |
| IIS é…ç½® | âœ… æ­£å¸¸ | è‡ªåŠ¨åŒ–é…ç½®æµç¨‹å®Œæ•´ |
| è®¡åˆ’ä»»åŠ¡ | âš ï¸ éƒ¨åˆ†æ­£å¸¸ | è„šæœ¬è·¯å¾„ç¡¬ç¼–ç ï¼Œçµæ´»æ€§ä¸è¶³ |

### 6.2 å…¼å®¹æ€§è¯„ä¼°

| å¹³å° | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| Windows + PowerShell 5.1 | âœ… å·²æµ‹è¯• | éœ€è¦æ‰‹åŠ¨åŠ è½½ `System.Net.Http` |
| Windows + PowerShell 7.x | âœ… å·²æµ‹è¯• | åŸç”Ÿæ”¯æŒ |
| macOS + PowerShell 7.x | âœ… å·²æµ‹è¯• | æ¨¡å—æ–‡æ¡£å£°æ˜æ”¯æŒ |
| Linux + PowerShell 7.x | âš ï¸ éƒ¨åˆ†æ”¯æŒ | systemd æœåŠ¡é…ç½®å­˜åœ¨ï¼Œä½†è·¯å¾„ä½¿ç”¨åæ–œæ ï¼ˆWindows é£æ ¼ï¼‰ |

---

## 7. å·²å‘ç°é—®é¢˜ä¸é£é™©

### 7.1 ä¸¥é‡é—®é¢˜

#### P1: `Invoke-HttpClientDownload` å¼‚å¸¸è¢«é™é»˜åå™¬

**æ–‡ä»¶**: `PSModule/MAUCacheAdmin/Private/Invoke-HttpClientDownload.ps1` ç¬¬ 72-74 è¡Œ

```powershell
catch {
    Write-Host "Not find $($Uri.OriginalString)" -ForegroundColor Yellow
}
```

**é—®é¢˜æè¿°**: æ‰€æœ‰ä¸‹è½½å¼‚å¸¸ï¼ˆåŒ…æ‹¬ç½‘ç»œè¶…æ—¶ã€æƒé™é—®é¢˜ã€ç£ç›˜ç©ºé—´ä¸è¶³ç­‰ï¼‰éƒ½è¢« catch å—æ•è·å¹¶ä»…è¾“å‡ºä¸€è¡Œ Write-Host æ¶ˆæ¯ï¼Œä¸ä¼šå‘ä¸ŠæŠ›å‡ºå¼‚å¸¸ã€‚è¿™å¯¼è‡´è°ƒç”¨æ–¹ `Invoke-MAUCacheDownload` ä¸­çš„é‡è¯•é€»è¾‘ï¼ˆç¬¬ 91-106 è¡Œï¼‰æ°¸è¿œä¸ä¼šè¢«è§¦å‘ã€‚

**å½±å“**: ä¸‹è½½å¤±è´¥æ—¶ä¸ä¼šé‡è¯•ï¼Œä¹Ÿä¸ä¼šæœ‰æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯ï¼Œéš¾ä»¥å®šä½é—®é¢˜ã€‚

**å»ºè®®**: åŒºåˆ†å¯æ¢å¤å’Œä¸å¯æ¢å¤é”™è¯¯ï¼Œå¯¹å¯æ¢å¤é”™è¯¯æŠ›å‡ºå¼‚å¸¸ä»¥è§¦å‘é‡è¯•ã€‚

#### P2: `CachePath` éªŒè¯é€»è¾‘ä¸ä¸€è‡´

**æ–‡ä»¶å¯¹æ¯”**:
- `Invoke-MAUCacheDownload.ps1` ç¬¬ 25-26 è¡Œ: `CachePath` ä¸å­˜åœ¨æ—¶æŠ›å‡ºå¼‚å¸¸
- `Save-MAUCollaterals.ps1` ç¬¬ 21-28 è¡Œ: `CachePath` ä¸å­˜åœ¨æ—¶è‡ªåŠ¨åˆ›å»º
- `Save-oldMAUCollaterals.ps1` ç¬¬ 16-18 è¡Œ: `CachePath` ä¸å­˜åœ¨æ—¶æŠ›å‡ºå¼‚å¸¸

**å½±å“**: åŒä¸€ä¸ª `CachePath` åœ¨ä¸åŒå‡½æ•°ä¸­çš„å¤„ç†æ–¹å¼ä¸ä¸€è‡´ï¼Œå¯èƒ½å¯¼è‡´ä½¿ç”¨è€…å›°æƒ‘ã€‚

#### P3: ä¸»è„šæœ¬ä¸­ `$maupath` é»˜è®¤å€¼ä¸ README ä¸ä¸€è‡´

**æ–‡ä»¶**: `MacUpdatesOffice.Modify.ps1` ç¬¬ 5 è¡Œ vs `README.md` ç¬¬ 51 è¡Œ

- è„šæœ¬é»˜è®¤å€¼: `C:\inetpub\wwwroot\maucache`
- README æ–‡æ¡£: `C:\inetpub\wwwroot\maunew6`

**å½±å“**: ç”¨æˆ·å¯èƒ½è¢«æ–‡æ¡£è¯¯å¯¼ï¼Œä½¿ç”¨é”™è¯¯çš„è·¯å¾„ã€‚

### 7.2 ä¸­ç­‰é—®é¢˜

#### P4: æ–‡ä»¶æ¸…ç†æ“ä½œåœ¨æ¨¡å—å¯¼å…¥å‰æ‰§è¡Œï¼Œä¸”ä½¿ç”¨é€’å½’åˆ é™¤

**æ–‡ä»¶**: `MacUpdatesOffice.Modify.ps1` ç¬¬ 15-36 è¡Œ

```powershell
$filesToDelete = @(
    "Lync Installer.pkg", "MicrosoftTeams.pkg", ...
    "*.xml", "builds.txt", "*.cat"
)
```

ä½¿ç”¨ `-Recurse` å‚æ•°åœ¨ `$maupath` ä¸‹é€’å½’åˆ é™¤æ‰€æœ‰åŒ¹é…æ–‡ä»¶ã€‚`*.xml` å’Œ `*.cat` è¿™ä¸¤ä¸ªé€šé…ç¬¦æ¨¡å¼ä¼šé€’å½’åˆ é™¤ `collateral/` å­ç›®å½•ä¸‹æ‰€æœ‰å·²ç¼“å­˜çš„ç¼–å½•æ–‡ä»¶ã€‚

**å½±å“**: æ¯æ¬¡è¿è¡Œæ—¶ä¼šåˆ é™¤ä¹‹å‰ä¿å­˜çš„æ‰€æœ‰ collateral æ–‡ä»¶ï¼Œç„¶åé‡æ–°ä¸‹è½½ï¼Œå¢åŠ ä¸å¿…è¦çš„ç½‘ç»œè´Ÿæ‹…å’Œæ‰§è¡Œæ—¶é—´ã€‚

#### P5: HttpClient ç”Ÿå‘½å‘¨æœŸç®¡ç†é—®é¢˜

**æ–‡ä»¶**: å¤šå¤„

- `Get-MAUApps.ps1`: åˆ›å»º HttpClient â†’ ä¼ é€’ç»™ Get-MAUApp â†’ Dispose
- `Get-MAUCacheDownloadJobs.ps1`: åˆ›å»º HttpClient â†’ ä½¿ç”¨ â†’ Dispose
- `Invoke-HttpClientDownload.ps1`: æ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–° HttpClient â†’ ä½¿ç”¨ â†’ Dispose

HttpClient çš„æœ€ä½³å®è·µæ˜¯å¤ç”¨å®ä¾‹ï¼Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯èƒ½å¯¼è‡´ç«¯å£è€—å°½ï¼ˆSocket Exhaustionï¼‰ã€‚

#### P6: `CreateScheduledTask.ps1` è„šæœ¬è·¯å¾„ç¡¬ç¼–ç 

**æ–‡ä»¶**: `CreateScheduledTask.ps1`

```powershell
$workDir="c:"
$taskScriptPath = "$workDir\MAU.ps1"
```

ç¡¬ç¼–ç è·¯å¾„ `c:\MAU.ps1`ï¼Œä½†å®é™…ä¸»è„šæœ¬åä¸º `MacUpdatesOffice.Modify.ps1`ï¼Œè·¯å¾„ä¹Ÿä¸åŒ¹é…ã€‚

#### P7: `PrepIISServer.ps1` ä¸­ Web ç«™ç‚¹è·¯å¾„ä¸ä¸»è„šæœ¬ä¸ä¸€è‡´

- PrepIISServer.ps1 è®¾ç½®ç«™ç‚¹è·¯å¾„ä¸º `C:\MAUupdate`
- ä¸»è„šæœ¬é»˜è®¤ç¼“å­˜è·¯å¾„ä¸º `C:\inetpub\wwwroot\maucache`

ä¸¤è€…ä¸ä¸€è‡´ï¼Œç”¨æˆ·éœ€è¦æ‰‹åŠ¨è°ƒæ•´å…¶ä¸­ä¸€ä¸ªã€‚

#### P8: ä¸‹è½½é‡è¯•é€»è¾‘ç¼ºé™·

**æ–‡ä»¶**: `Invoke-MAUCacheDownload.ps1` ç¬¬ 90-106 è¡Œ

```powershell
$dlAttempt = 0
while ($dlAttempt -lt 2) {
    try {
        Invoke-HttpClientDownload ...
        break
    }
    catch {
        ...
        $dlAttempt++
    }
}
```

ç”±äº P1 ä¸­çš„é—®é¢˜ï¼ˆ`Invoke-HttpClientDownload` å†…éƒ¨ catch äº†æ‰€æœ‰å¼‚å¸¸ï¼‰ï¼Œæ­¤é‡è¯•é€»è¾‘å®é™…ä¸Šæ°¸è¿œä¸ä¼šè¿›å…¥ catch å—ã€‚å³ä½¿ä¿®å¤äº† P1ï¼Œé‡è¯•æ¬¡æ•°ä»…ä¸º 2 æ¬¡ï¼ˆå®é™…åªä¼šé‡è¯• 1 æ¬¡åé€€å‡ºå¾ªç¯ï¼‰ï¼Œä¸”æ²¡æœ‰æŒ‡æ•°é€€é¿ï¼ˆexponential backoffï¼‰ã€‚

#### P9: `Save-MAUCollaterals` ä¸­ URI æ‹¼æ¥é€»è¾‘è„†å¼±

**æ–‡ä»¶**: `Save-MAUCollaterals.ps1` ç¬¬ 47-54 è¡Œ

```powershell
$originalUri = $mauApp.CollateralURIs.CAT.OriginalString
$lastSlashIndex = $originalUri.LastIndexOf('/')
$baseUri = $originalUri.Substring(0, $lastSlashIndex + 1)
$fileName = $originalUri.Substring($lastSlashIndex + 1)
$fileNameParts = $fileName -split '\.'
$newFileName = $fileNameParts[0] + "_" + $ver + "." + $fileNameParts[1]
```

ä½¿ç”¨å­—ç¬¦ä¸²æ“ä½œè€Œé URI ç±»æ–¹æ³•æ¥æ„å»º URIï¼Œå½“æ–‡ä»¶ååŒ…å«å¤šä¸ª `.` æˆ– URI æ ¼å¼å˜åŒ–æ—¶å¯èƒ½äº§ç”Ÿé”™è¯¯ã€‚

### 7.3 è½»å¾®é—®é¢˜

#### P10: æ¨¡å—æ¸…å• `RequiredAssemblies` ä¸ä¸»è„šæœ¬é‡å¤åŠ è½½

**æ–‡ä»¶**: `MAUCacheAdmin.psd1` ç¬¬ 31 è¡Œ + `MacUpdatesOffice.Modify.ps1` ç¬¬ 42 è¡Œ

```powershell
# psd1
RequiredAssemblies = @("System.Net.Http")

# ä¸»è„šæœ¬
Add-Type -AssemblyName System.Net.Http
```

ä¸¤å¤„éƒ½åŠ è½½äº† `System.Net.Http`ï¼Œè™½ç„¶ä¸ä¼šå¯¼è‡´é”™è¯¯ï¼Œä½†å±äºå†—ä½™ã€‚

#### P11: `$builds` å˜é‡æœªè¢«ä½¿ç”¨çš„æ€§èƒ½å¼€é”€

**æ–‡ä»¶**: `MacUpdatesOffice.Modify.ps1` ç¬¬ 45-57 è¡Œ

`$builds = Get-MAUProductionBuilds` è·å–äº†æ„å»ºç‰ˆæœ¬ï¼Œç„¶ååœ¨å¾ªç¯ä¸­ä½¿ç”¨ã€‚ä½†å¾ªç¯æ˜¯å¯¹æ¯ä¸ª app å•ç‹¬è°ƒç”¨ `Get-MAUCacheDownloadJobs`ï¼Œæ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„ HttpClient å¹¶å‘é€ HEAD è¯·æ±‚ï¼Œæ— æ³•å…±äº«è¿æ¥ã€‚

#### P12: è¿›åº¦æ¡ ID å†²çª

`Get-MAUCacheDownloadJobs` ä½¿ç”¨ `-Id 0` å’Œ `-Id 1`ï¼Œ`Get-MAUApps` ä¹Ÿä½¿ç”¨ `-Id 0`ï¼Œå½“åµŒå¥—è°ƒç”¨æ—¶å¯èƒ½å¯¼è‡´è¿›åº¦æ¡æ˜¾ç¤ºæ··ä¹±ã€‚

#### P13: é”™è¯¯æ¶ˆæ¯è¯­æ³•é—®é¢˜

**æ–‡ä»¶**: `Invoke-HttpClientDownload.ps1` ç¬¬ 73 è¡Œ

```powershell
Write-Host "Not find $($Uri.OriginalString)" -ForegroundColor Yellow
```

åº”ä¸º "Not found" æˆ– "Cannot find"ã€‚

#### P14: æµ‹è¯•æ–‡ä»¶ä¸­å­˜åœ¨å˜é‡åé”™è¯¯

**æ–‡ä»¶**: `PSModule/MAUCacheAdmin.Tests.ps1` ç¬¬ 23 è¡Œ

```powershell
Write-Debug "Debug $($script.Count)"
```

åº”ä¸º `$scripts.Count`ï¼ˆç¼ºå°‘ sï¼‰ã€‚

---

## 8. æ”¹è¿›æ„è§

### 8.1 é«˜ä¼˜å…ˆçº§æ”¹è¿›

#### M1: ä¿®å¤ `Invoke-HttpClientDownload` çš„é”™è¯¯å¤„ç†

```powershell
# å½“å‰ä»£ç 
catch {
    Write-Host "Not find $($Uri.OriginalString)" -ForegroundColor Yellow
}

# å»ºè®®æ”¹ä¸º
catch {
    Write-Warning "Failed to download $($Uri.OriginalString): $($_.Exception.Message)"
    throw  # å‘ä¸ŠæŠ›å‡ºå¼‚å¸¸ï¼Œè®©è°ƒç”¨æ–¹å†³å®šå¦‚ä½•å¤„ç†
}
```

#### M2: ç»Ÿä¸€ `CachePath` éªŒè¯é€»è¾‘

å»ºè®®ç»Ÿä¸€ä½¿ç”¨"ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º"çš„æ¨¡å¼ï¼š

```powershell
if (-not (Test-Path -Path $CachePath)) {
    New-Item -ItemType Directory -Path $CachePath -Force | Out-Null
    Write-Verbose "Created cache directory: $CachePath"
}
```

#### M3: ä¿®å¤ README ä¸­çš„é»˜è®¤å€¼æè¿°

å°† README ä¸­çš„ `C:\inetpub\wwwroot\maunew6` æ›´æ–°ä¸ºä¸è„šæœ¬ä¸€è‡´çš„ `C:\inetpub\wwwroot\maucache`ã€‚

#### M4: ä¼˜åŒ–æ–‡ä»¶æ¸…ç†é€»è¾‘

å°† `*.xml` å’Œ `*.cat` çš„é€’å½’åˆ é™¤é™åˆ¶ä¸ºæ ¹ç›®å½•ï¼Œé¿å…åˆ é™¤ `collateral/` å­ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š

```powershell
# ä»…åˆ é™¤æ ¹ç›®å½•ä¸‹çš„ xml å’Œ catï¼Œä¸é€’å½’
$rootOnlyPatterns = @("*.xml", "*.cat")
$recursivePatterns = @("Lync Installer.pkg", "MicrosoftTeams.pkg", ...)

foreach ($pattern in $rootOnlyPatterns) {
    Get-ChildItem -Path $maupath -Filter $pattern -File | Remove-Item -Force
}
foreach ($pattern in $recursivePatterns) {
    Get-ChildItem -Path $maupath -Filter $pattern -Recurse | Remove-Item -Force
}
```

### 8.2 ä¸­ä¼˜å…ˆçº§æ”¹è¿›

#### M5: ä¼˜åŒ– HttpClient ç”Ÿå‘½å‘¨æœŸ

ä½¿ç”¨ `IHttpClientFactory` æ¨¡å¼æˆ–è‡³å°‘åœ¨æ¨¡å—çº§åˆ«å¤ç”¨ HttpClientï¼š

```powershell
# åœ¨æ¨¡å—ä½œç”¨åŸŸç»´æŠ¤ HttpClient å•ä¾‹
function Get-MAUHttpClient {
    if ($null -eq $Script:HttpClient) {
        $Script:HttpClient = [System.Net.Http.HttpClient]::new((Get-HttpClientHandler), $false)
        $Script:HttpClient.Timeout = [TimeSpan]::FromMinutes(30)
    }
    return $Script:HttpClient
}
```

#### M6: å‚æ•°åŒ– `CreateScheduledTask.ps1`

```powershell
param(
    [string]$TaskScriptPath = "C:\MAUCacheAdmin.Modify-main\MacUpdatesOffice.Modify.ps1",
    [string]$TaskName = "MAU Cache Update",
    [ValidateSet("Once","Weekly")]
    [string]$Schedule = "Weekly",
    [string]$DayOfWeek = "Saturday",
    [string]$Time = "01:00"
)
```

#### M7: ç»Ÿä¸€ `PrepIISServer.ps1` ä¸ä¸»è„šæœ¬çš„é»˜è®¤è·¯å¾„

å°† `PrepIISServer.ps1` çš„ç«™ç‚¹è·¯å¾„å‚æ•°åŒ–ï¼Œå¹¶ä½¿ç”¨ä¸ä¸»è„šæœ¬ä¸€è‡´çš„é»˜è®¤å€¼ï¼š

```powershell
param(
    [string]$SitePath = "C:\inetpub\wwwroot\maucache"
)
```

#### M8: å¢å¼ºä¸‹è½½é‡è¯•é€»è¾‘

```powershell
$maxRetries = 3
$dlAttempt = 0
while ($dlAttempt -lt $maxRetries) {
    try {
        Invoke-HttpClientDownload -Uri $dlJob.LocationUri -OutFile $targetScratchItem.FullName -UseRemoteLastModified -Force
        break
    }
    catch {
        $dlAttempt++
        if ($dlAttempt -ge $maxRetries) { throw }
        $backoffSeconds = [Math]::Pow(2, $dlAttempt) * 5
        Write-Warning "Download failed (attempt $dlAttempt/$maxRetries), retrying in $backoffSeconds seconds..."
        Start-Sleep -Seconds $backoffSeconds
    }
}
```

#### M9: ä½¿ç”¨ URI ç±»æ–¹æ³•æ„å»ºç¼–å½•æ–‡ä»¶ URI

```powershell
$baseUri = [Uri]::new($mauApp.CollateralURIs.CAT, ".")
$catFileName = [System.IO.Path]::GetFileNameWithoutExtension($mauApp.CollateralURIs.CAT.Segments[-1])
$catExtension = [System.IO.Path]::GetExtension($mauApp.CollateralURIs.CAT.Segments[-1])
$versionedCatUri = [Uri]::new($baseUri, "${catFileName}_${ver}${catExtension}")
```

### 8.3 ä½ä¼˜å…ˆçº§æ”¹è¿›

#### M10: æ·»åŠ æ—¥å¿—è®°å½•åŠŸèƒ½

å»ºè®®æ·»åŠ ç»“æ„åŒ–æ—¥å¿—åŠŸèƒ½ï¼Œæ”¯æŒè¾“å‡ºåˆ°æ–‡ä»¶ï¼š

```powershell
function Write-MAULog {
    param(
        [string]$Message,
        [ValidateSet("Info","Warning","Error")]
        [string]$Level = "Info"
    )
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $logEntry = "[$timestamp] [$Level] $Message"
    Add-Content -Path $Script:LogPath -Value $logEntry
    switch ($Level) {
        "Warning" { Write-Warning $Message }
        "Error" { Write-Error $Message }
        default { Write-Verbose $Message }
    }
}
```

#### M11: æ·»åŠ æ ¡éªŒå’ŒéªŒè¯

ä¸‹è½½åå¯¹æ–‡ä»¶è¿›è¡Œå“ˆå¸Œæ ¡éªŒï¼ˆå¦‚æœ CDN æä¾›äº†æ ¡éªŒä¿¡æ¯ï¼‰ï¼š

```powershell
$expectedHash = $dlJob.Hash  # å¦‚æœå¯ç”¨
if ($expectedHash) {
    $actualHash = (Get-FileHash -Path $targetPath -Algorithm SHA256).Hash
    if ($actualHash -ne $expectedHash) {
        throw "Hash mismatch for $($dlJob.Payload)"
    }
}
```

#### M12: ä¿®å¤æµ‹è¯•æ–‡ä»¶ä¸­çš„å˜é‡åé”™è¯¯

```powershell
# ä¿®å¤
Write-Debug "Debug $($scripts.Count)"
```

---

## 9. åŠŸèƒ½æ–°å¢å»ºè®®

### 9.1 å¹¶è¡Œä¸‹è½½æ”¯æŒ

**éœ€æ±‚**: å½“å‰ä¸‹è½½é€»è¾‘ä¸ºä¸²è¡Œï¼ˆForEach-Object åŒæ­¥ï¼‰ï¼Œå¯¹äºå¤§é‡æ–‡ä»¶ä¸‹è½½æ•ˆç‡ä½ä¸‹ã€‚

**å»ºè®®**: ä½¿ç”¨ PowerShell 7 çš„ `ForEach-Object -Parallel` æˆ– `Start-Job` å®ç°å¹¶è¡Œä¸‹è½½ï¼š

```powershell
# PowerShell 7+ ç‰ˆæœ¬
$apps | ForEach-Object -Parallel {
    $dlJobs = Get-MAUCacheDownloadJobs -MAUApps $_ -DeltaFromBuildLimiter $using:builds
    Invoke-MAUCacheDownload -MAUCacheDownloadJobs $dlJobs -CachePath $using:maupath -ScratchPath $using:mautemppath -Force
} -ThrottleLimit 4
```

### 9.2 å¢é‡æ›´æ–°æ£€æµ‹

**éœ€æ±‚**: å½“å‰æ¯æ¬¡è¿è¡Œéƒ½ä¼šåˆ é™¤æ‰€æœ‰ XML å’Œ CAT æ–‡ä»¶å¹¶é‡æ–°ä¸‹è½½ã€‚

**å»ºè®®**: ä»…åœ¨ç‰ˆæœ¬å‘ç”Ÿå˜åŒ–æ—¶æ‰é‡æ–°ä¸‹è½½ç¼–å½•æ–‡ä»¶ï¼š

```powershell
function Test-MAUCacheUpToDate {
    param($CachePath, $MAUApps)
    
    $versionFile = Join-Path $CachePath ".mau-cache-version"
    if (-not (Test-Path $versionFile)) { return $false }
    
    $cached = Get-Content $versionFile | ConvertFrom-Json
    $current = $MAUApps | ForEach-Object { @{AppID=$_.AppID; Version=$_.VersionInfo.Version} }
    
    return ($cached | ConvertTo-Json) -eq ($current | ConvertTo-Json)
}
```

### 9.3 é‚®ä»¶/Webhook é€šçŸ¥

**éœ€æ±‚**: ç¼“å­˜æ›´æ–°å®Œæˆæˆ–å¤±è´¥æ—¶é€šçŸ¥ç®¡ç†å‘˜ã€‚

**å»ºè®®**:

```powershell
function Send-MAUNotification {
    param(
        [string]$Subject,
        [string]$Body,
        [ValidateSet("Email","Teams","Slack")]
        [string]$Method = "Email"
    )
    
    switch ($Method) {
        "Email" {
            Send-MailMessage -To $Config.NotifyEmail -Subject $Subject -Body $Body -SmtpServer $Config.SmtpServer
        }
        "Teams" {
            $payload = @{ text = "$Subject`n$Body" } | ConvertTo-Json
            Invoke-RestMethod -Uri $Config.TeamsWebhook -Method Post -Body $payload -ContentType "application/json"
        }
    }
}
```

### 9.4 é…ç½®æ–‡ä»¶æ”¯æŒ

**éœ€æ±‚**: å°†ç¡¬ç¼–ç å‚æ•°å¤–éƒ¨åŒ–ä¸ºé…ç½®æ–‡ä»¶ã€‚

**å»ºè®®**: æ”¯æŒ JSON é…ç½®æ–‡ä»¶ï¼š

```json
{
    "workPath": "C:\\MAUCacheAdmin.Modify-main",
    "cachePath": "C:\\inetpub\\wwwroot\\maucache",
    "scratchPath": "C:\\MAUCacheAdmin.Modify-main\\temp",
    "channel": "Production",
    "maxRetries": 3,
    "parallelDownloads": 4,
    "notification": {
        "enabled": true,
        "method": "Email",
        "recipients": ["admin@example.com"]
    },
    "excludeApps": ["0409MSFB16"],
    "includeHistoricDeltas": false
}
```

### 9.5 ç¼“å­˜æ¸…ç†ç­–ç•¥

**éœ€æ±‚**: è‡ªåŠ¨æ¸…ç†è¶…è¿‡ä¸€å®šæ—¶é—´çš„æ—§ç‰ˆæœ¬ç¼“å­˜æ–‡ä»¶ã€‚

**å»ºè®®**:

```powershell
function Invoke-MAUCacheCleanup {
    param(
        [string]$CachePath,
        [int]$RetentionDays = 90
    )
    
    $threshold = (Get-Date).AddDays(-$RetentionDays)
    $oldFiles = Get-ChildItem -Path $CachePath -Recurse -File | Where-Object { $_.LastWriteTime -lt $threshold }
    
    Write-Host "Found $($oldFiles.Count) files older than $RetentionDays days"
    $oldFiles | Remove-Item -Force -WhatIf  # å…ˆé¢„è§ˆ
}
```

### 9.6 å¥åº·æ£€æŸ¥ç«¯ç‚¹

**éœ€æ±‚**: ä¸ºç¼“å­˜æœåŠ¡å™¨æä¾›å¥åº·æ£€æŸ¥æ¥å£ã€‚

**å»ºè®®**: ç”Ÿæˆä¸€ä¸ªçŠ¶æ€ JSON æ–‡ä»¶ï¼Œå¯è¢«ç›‘æ§ç³»ç»Ÿè½®è¯¢ï¼š

```powershell
function Update-MAUCacheStatus {
    param($CachePath, $MAUApps)
    
    $status = @{
        lastUpdate = (Get-Date).ToString("o")
        appCount = $MAUApps.Count
        totalFiles = (Get-ChildItem $CachePath -Recurse -File).Count
        totalSize = (Get-ChildItem $CachePath -Recurse -File | Measure-Object Length -Sum).Sum
        apps = $MAUApps | ForEach-Object { @{name=$_.AppName; version=$_.VersionInfo.Version} }
    }
    
    $status | ConvertTo-Json -Depth 3 | Set-Content (Join-Path $CachePath "status.json")
}
```

### 9.7 æ”¯æŒé€‰æ‹©æ€§åº”ç”¨ä¸‹è½½

**éœ€æ±‚**: å…è®¸ç”¨æˆ·ä»…ä¸‹è½½ç‰¹å®šåº”ç”¨çš„æ›´æ–°ï¼ˆå¦‚ä»…ä¸‹è½½ Word å’Œ Excelï¼‰ã€‚

**å»ºè®®**:

```powershell
param(
    [string[]]$IncludeApps,   # å¦‚ @("Word", "Excel")
    [string[]]$ExcludeApps    # å¦‚ @("Skype for Business", "Teams 1.0 classic")
)
```

### 9.8 å¸¦å®½é™åˆ¶

**éœ€æ±‚**: åœ¨å…±äº«ç½‘ç»œç¯å¢ƒä¸­é¿å…ä¸‹è½½å ç”¨è¿‡å¤šå¸¦å®½ã€‚

**å»ºè®®**: åœ¨ `Invoke-HttpClientDownload` ä¸­å®ç°é€Ÿç‡é™åˆ¶ï¼š

```powershell
param(
    [int]$MaxBytesPerSecond = 0  # 0 = æ— é™åˆ¶
)

# åœ¨è¯»å–å¾ªç¯ä¸­åŠ å…¥å»¶è¿Ÿ
if ($MaxBytesPerSecond -gt 0) {
    $elapsed = [DateTime]::Now - $downloadStart
    $expectedTime = $totalBytesRead / $MaxBytesPerSecond
    if ($expectedTime -gt $elapsed.TotalSeconds) {
        Start-Sleep -Milliseconds (($expectedTime - $elapsed.TotalSeconds) * 1000)
    }
}
```

### 9.9 Docker å®¹å™¨åŒ–æ”¯æŒ

**éœ€æ±‚**: ä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²ç®€åŒ–æœåŠ¡å™¨é…ç½®ã€‚

**å»ºè®®**: åˆ›å»º Dockerfileï¼š

```dockerfile
FROM mcr.microsoft.com/powershell:latest
RUN apt-get update && apt-get install -y nginx
COPY . /app/MAUCacheAdmin
COPY nginx.conf /etc/nginx/nginx.conf
VOLUME /cache
EXPOSE 80
CMD ["pwsh", "-File", "/app/MAUCacheAdmin/MacUpdatesOffice.Modify.ps1", "-maupath", "/cache"]
```

### 9.10 ç¼“å­˜ç»Ÿè®¡æŠ¥å‘Š

**éœ€æ±‚**: æä¾›ç¼“å­˜ä½¿ç”¨æƒ…å†µçš„ç»Ÿè®¡æŠ¥å‘Šã€‚

**å»ºè®®**:

```powershell
function Get-MAUCacheReport {
    param([string]$CachePath)
    
    $files = Get-ChildItem -Path $CachePath -Recurse -File
    
    return [PSCustomObject]@{
        TotalFiles = $files.Count
        TotalSize = ConvertFrom-BytesToString ($files | Measure-Object Length -Sum).Sum
        PkgFiles = ($files | Where-Object Extension -eq '.pkg').Count
        XmlFiles = ($files | Where-Object Extension -eq '.xml').Count
        CatFiles = ($files | Where-Object Extension -eq '.cat').Count
        OldestFile = ($files | Sort-Object LastWriteTime | Select-Object -First 1).LastWriteTime
        NewestFile = ($files | Sort-Object LastWriteTime -Descending | Select-Object -First 1).LastWriteTime
    }
}
```

---

## 10. æ€»ç»“

### æ•´ä½“è¯„ä»·

MAUCacheAdmin.Modify æ˜¯ä¸€ä¸ªåŠŸèƒ½åŸºæœ¬å®Œæ•´çš„ Microsoft AutoUpdate ç¼“å­˜ç®¡ç†å·¥å…·ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œé‡‡ç”¨äº† PowerShell æ¨¡å—åŒ–çš„æœ€ä½³å®è·µï¼ˆPublic/Private åˆ†å±‚ï¼‰ï¼Œæ ¸å¿ƒåŠŸèƒ½ï¼ˆCDN é€šä¿¡ã€Plist è§£æã€æ–‡ä»¶ä¸‹è½½ï¼‰å®ç°å¯é ã€‚

### å…³é”®é£é™©ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ç¼–å· | é—®é¢˜ | å»ºè®® |
|--------|------|------|------|
| ğŸ”´ é«˜ | P1 | ä¸‹è½½å¼‚å¸¸è¢«é™é»˜åå™¬ | ä¿®å¤ catch å—ï¼Œå‘ä¸ŠæŠ›å‡ºå¼‚å¸¸ |
| ğŸ”´ é«˜ | P4 | é€’å½’åˆ é™¤ `*.xml`/`*.cat` å½±å“ collateral | é™åˆ¶åˆ é™¤èŒƒå›´ |
| ğŸŸ¡ ä¸­ | P2 | CachePath éªŒè¯ä¸ä¸€è‡´ | ç»Ÿä¸€è¡Œä¸º |
| ğŸŸ¡ ä¸­ | P3 | README é»˜è®¤å€¼ä¸ä¸€è‡´ | æ›´æ–°æ–‡æ¡£ |
| ğŸŸ¡ ä¸­ | P5 | HttpClient é¢‘ç¹åˆ›å»º/é”€æ¯ | å¤ç”¨å®ä¾‹ |
| ğŸŸ¡ ä¸­ | P6 | è®¡åˆ’ä»»åŠ¡è·¯å¾„ç¡¬ç¼–ç  | å‚æ•°åŒ– |
| ğŸŸ¡ ä¸­ | P7 | IIS è·¯å¾„ä¸ä¸»è„šæœ¬ä¸ä¸€è‡´ | ç»Ÿä¸€é»˜è®¤å€¼ |
| ğŸŸ¡ ä¸­ | P8 | é‡è¯•é€»è¾‘æ— æ³•è§¦å‘ | ä¾èµ– P1 ä¿®å¤ |
| ğŸŸ¢ ä½ | P9-P14 | URIæ‹¼æ¥/å†—ä½™åŠ è½½/æµ‹è¯•é”™è¯¯ç­‰ | é€æ­¥ä¿®å¤ |

### åŠŸèƒ½æ–°å¢ä¼˜å…ˆçº§å»ºè®®

| ä¼˜å…ˆçº§ | åŠŸèƒ½ | ä»·å€¼ |
|--------|------|------|
| ğŸ”´ é«˜ | å¹¶è¡Œä¸‹è½½æ”¯æŒ | æ˜¾è‘—æå‡æ›´æ–°é€Ÿåº¦ |
| ğŸ”´ é«˜ | é…ç½®æ–‡ä»¶æ”¯æŒ | æå‡å¯ç»´æŠ¤æ€§å’Œéƒ¨ç½²çµæ´»æ€§ |
| ğŸŸ¡ ä¸­ | é‚®ä»¶/Webhook é€šçŸ¥ | æå‡è¿ç»´å¯è§‚æµ‹æ€§ |
| ğŸŸ¡ ä¸­ | å¢é‡æ›´æ–°æ£€æµ‹ | å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ |
| ğŸŸ¡ ä¸­ | é€‰æ‹©æ€§åº”ç”¨ä¸‹è½½ | æ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ |
| ğŸŸ¡ ä¸­ | ç¼“å­˜æ¸…ç†ç­–ç•¥ | è‡ªåŠ¨åŒ–ç£ç›˜ç©ºé—´ç®¡ç† |
| ğŸŸ¢ ä½ | å¥åº·æ£€æŸ¥ç«¯ç‚¹ | ä¾¿äºç›‘æ§é›†æˆ |
| ğŸŸ¢ ä½ | ç¼“å­˜ç»Ÿè®¡æŠ¥å‘Š | ä¾¿äºè¿ç»´ç®¡ç† |
| ğŸŸ¢ ä½ | å¸¦å®½é™åˆ¶ | é€‚ç”¨äºå…±äº«ç½‘ç»œç¯å¢ƒ |
| ğŸŸ¢ ä½ | Docker å®¹å™¨åŒ– | ç®€åŒ–éƒ¨ç½² |
